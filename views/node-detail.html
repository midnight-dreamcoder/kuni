<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Title }} - K8s Universal Inspector</title>
    <link rel="stylesheet" href="/style.css{{ .CacheBuster }}">
</head>
<body>

    {{ template "sidebar" . }}

    <main class="main-content">
        <h1>{{ .NodeName }}</h1>
        <div class="page-subtitle">
            Node in <strong>{{ .ClusterName }}</strong>
        </div>

        {{ if .ErrorLogs }}
        <div class="errors">
            <h2>Errors</h2>
            <ul>
                {{ range .ErrorLogs }} <li>{{ . }}</li> {{ end }}
            </ul>
        </div>
        {{ end }}
        
        <div class="detail-grid">
            
            <div class="detail-main">
                
                <div class="container">
                    <h2>Pods ({{ len .Pods }})</h2>
                    <table>
                        <thead>
                            <tr>
                                <th class="col-pod-name">Name</th>
                                <th>Ready</th>
                                <th>Status</th>
                                <th>Reason</th>
                                <th>Restarts</th>
                                <th>IP</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{ range .Pods }}
                            <tr>
                                <td class="col-pod-name">
                                    <a href="{{ MakeURL $.QueryString "/pod/detail" "name" .Name "namespace" .Namespace "cluster_name" .Cluster }}" class="deployment-link">
                                        {{ .Name }}
                                    </a>
                                </td>
                                <td>{{ .Ready }}</td>
                                <td><span class="status status-{{ .Status | ToLower }}">{{ .Status }}</span></td>
                                <td class="reason-col">{{ .Reason }}</td>
                                <td>{{ .Restarts }}</td>
                                <td>{{ .PodIP }}</td>
                            </tr>
                            {{ else }}
                            <tr><td colspan="6" class="no-data">No pods found on this node.</td></tr>
                            {{ end }}
                        </tbody>
                    </table>
                </div>
                
                <div class="container">
                    <h2>Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Last Seen</th>
                                <th>Type</th>
                                <th>Reason</th>
                                <th>Count</th>
                                <th>Message</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{ range .Events }}
                            <tr class="{{ if eq .Type "Warning" }}event-warning{{ else }}event-normal{{ end }}">
                                <td>{{ .LastSeen }}</td>
                                <td>{{ .Type }}</td>
                                <td>{{ .Reason }}</td>
                                <td>{{ .Count }}</td>
                                <td style="white-space: normal;">{{ .Message }}</td>
                            </tr>
                            {{ else }}
                            <tr><td colspan="5" class="no-data">No events found for this node.</td></tr>
                            {{ end }}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="detail-sidebar">
                
                <div class="overview-box">
                    <h2>Node Info</h2>
                    <ul class="overview-list">
                        <li><strong>Role</strong> <span class="cluster-tag">{{ .Role }}</span></li>
                        <li><strong>Kubelet</strong> <span>{{ .KubeletVersion }}</span></li>
                        <li><strong>OS</strong> <span>{{ .OS }}</span></li>
                        <li><strong>Runtime</strong> <span>{{ .ContainerRuntime }}</span></li>
                        <li><strong>Provider ID</strong> <span>{{ .ProviderID }}</span></li>
                        <li><strong>Age</strong> <span>{{ .Age }}</span></li>
                    </ul>
                </div>
                
                <div class="overview-box">
                    <h2>Addresses</h2>
                    <ul class="overview-list">
                        {{ range .Addresses }}
                        <li><strong>{{ .Type }}</strong> <span>{{ .Address }}</span></li>
                        {{ else }}
                        <li><strong>None</strong> <span>No addresses found.</span></li>
                        {{ end }}
                    </ul>
                </div>

                <div class="overview-box">
                    <h2>Taints</h2>
                    <div class="tag-list" style="padding: 1.5rem;">
                        {{ range .Taints }}
                        <span class="status status-failed" title="{{ .Key }}={{ .Value }}:{{ .Effect }}">{{ .Key }}:{{ .Effect }}</span>
                        {{ else }}
                        <span class="no-data" style="padding: 0; text-align: left;">No taints.</span>
                        {{ end }}
                    </div>
                </div>

                <div class="container">
                    <h2>Resources</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Resource</th>
                                <th>Capacity</th>
                                <th>Allocatable</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>cpu</td><td>{{ index .Capacity "cpu" }}</td><td>{{ index .Allocatable "cpu" }}</td></tr>
                            <tr><td>memory</td><td>{{ index .Capacity "memory" }}</td><td>{{ index .Allocatable "memory" }}</td></tr>
                            <tr><td>pods</td><td>{{ index .Capacity "pods" }}</td><td>{{ index .Allocatable "pods" }}</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="container">
                    <h2>Conditions</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Reason</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{ range .Conditions }}
                            <tr>
                                <td>{{ .Type }}</td>
                                <td>{{ .Status }}</td>
                                <td>{{ .Reason }}</td>
                            </tr>
                            {{ else }}
                            <tr><td colspan="3" class="no-data">No conditions found.</td></tr>
                            {{ end }}
                        </tbody>
                    </table>
                </div>

                <div class="overview-box">
                    <h2>Labels</h2>
                    <div class="key-value-list" style="padding: 1rem 1.5rem; max-height: 400px; overflow-y: auto;">
                        {{ range $k, $v := .Labels }}
                        <div><span class="data-key" title="{{ $k }}">{{ $k }}</span> <span class="data-value">{{ $v }}</span></div>
                        {{ else }}
                        <span class="no-data" style="padding: 0.5rem 0; text-align: center; display: block;">No labels.</span>
                        {{ end }}
                    </div>
                </div>
                
                <div class="overview-box">
                    <h2>Annotations</h2>
                    <div class="key-value-list" style="padding: 1rem 1.5rem; max-height: 400px; overflow-y: auto;">
                        {{ range $k, $v := .Annotations }}
                        <div><span class="data-key" title="{{ $k }}">{{ $k }}</span> <span class="data-value">{{ $v }}</span></div>
                        {{ else }}
                        <span class="no-data" style="padding: 0.5rem 0; text-align: center; display: block;">No annotations.</span>
                        {{ end }}
                    </div>
                </div>

            </div>

        </div>
    </main>

</body>
</html>